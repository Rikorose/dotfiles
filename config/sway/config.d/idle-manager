set $locker 'swaylock -i ~/wallpaper -s fill'
exec swayidle \
    timeout 300 $locker \
    timeout 600 'if cat /sys/class/power_supply/BAT*/status | rg Discharging -c; then systemctl suspend; fi' \
        resume 'swaymsg "output * dpms on"' \
    timeout 3600 'systemctl suspend' \
        resume 'swaymsg "output * dpms on"' \
    timeout 30 'if pgrep -x swaylock; then swaymsg "output * dpms off"; fi' \
        resume 'swaymsg "output * dpms on"' \
    before-sleep $locker
