#!/bin/sh

cmd="swaymsg -t get_tree | jq '.. | .floating_nodes? | arrays | .. | .name? | strings |
  select(.==\"scratchterm\")' | wc -l"

if [[ ! $(eval $cmd) -ge 1 ]]; then
  echo "Launching scratchterm"
  swaymsg exec "alacritty -t scratchterm"
  # Wait until sway has updated its tree
  echo $(eval $cmd)
  while [[ ! $(eval $cmd) -ge 1 ]]; do
    sleep 0.01
  done
fi
swaymsg "[title=scratchterm] scratchpad show"
